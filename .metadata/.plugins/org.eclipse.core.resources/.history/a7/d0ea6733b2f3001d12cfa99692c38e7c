package com.hk.bookDemoJPANew.controller;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;

import com.hk.bookDemo.service.BookService;
import com.hk.bookDemo.vo.BookVO;
import com.hk.bookDemoJPANew.entity.Book;

@Controller
public class BookController {
	
	@Autowired
	BookService bookService;
	
	@GetMapping("/")
	public String home() {
		return "home"; // JSP는 WEB-INF/views/home.jsp를 찾았지만
				// Thymeleaf는 src/main/resources/templates에서 home.html을 찾는다.
				// 관련 설정 application.properties
	}
	
	@GetMapping("/create") // url에 매핑
	public String create() {
		return "book/create"; // 해당 파일을 찾는 루트, 기본설정이 html 확장자
	}
	
	@PostMapping("/create")
	public String createPost(Book book) {
		// service 호출
		// DB에 사용자가 입력한 값을 저장하고..
		// 입력된 book_id를 가지고 상세페이지로 넘기기
		// if문으로 로직 처리
		
		// 1. bookService에 create method를 호출
		long book_id = bookService.create(book);
		if (book_id == 0) {
			// 에러
			return "redirect:/create"; 
		} else {
			// 성공
			return "redirect:/detail?bookId=" + book_id;
		}
		// 2. 호출한 결과를 long리턴 why? VO에 long으로 book_id가 되어있기 떄문
	}
}
